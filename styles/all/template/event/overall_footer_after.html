<!-- IF S_IN_USERMAP -->
<!-- IF MAP_TYPE == 'osm' -->
	<!-- INCLUDEJS @tas2580_usermap/osmscript.js -->
	<script type="text/javascript">
	// <![CDATA[
	function display_map() {
		OpenLayers.Lang.setCode('{S_USER_LANG}');
		drawmap({USERMAP_LON}, {USERMAP_LAT}, {USERMAP_ZOOM}, {USERMAP_CONTROLS});
		<!-- IF A_USERMAP_ADD or A_USERMAP_SEARCH -->
			$('#map').css('cursor', 'crosshair');
			click.activate();
		<!-- ENDIF -->
	}

	function reload_marker(Alon, Alat, Blon, Blat) {
		layer_markers.clearMarkers();
		$.get('{U_GET_MARKER}?alon='+Alon+'&alat='+Alat+'&blon='+Blon+'&blat='+Blat, function(returndata){
			returndata.forEach(function(element, index, array) {
				var marker = generateMarker('{MARKER_PATH}/'+element.marker);
				addMarker(layer_markers, parseFloat(element.lon), parseFloat(element.lat), element.title+'<br>{L_DISTANCE}{L_COLON} '+element.distance, marker);
			});
		});
	}

	$('document').ready(display_map);
// ]]>
	</script>
<!-- ENDIF -->

<!-- IF MAP_TYPE == 'google' -->
	<script type="text/javascript">
	var map;
	function initMap() {
		map = new google.maps.Map(document.getElementById('map'), {
			center: {lat: {USERMAP_LAT}, lng: {USERMAP_LON}},
			zoom: {USERMAP_ZOOM}
		});
		  // Generate markers
		<!-- BEGIN group_list -->
			var marker_{group_list.GROUP_ID} = '{MARKER_PATH}/{group_list.MARKER}';
		<!-- END group_list -->
		<!-- BEGIN user_list -->
			var marker = new google.maps.Marker({
				position: {lat: {user_list.LAT}, lng: {user_list.LON}},
				map: map,
				title: '{user_list.USERNAME_SIMPLE}',
				icon: marker_{user_list.GROUP_ID}
			});
		<!-- END user_list -->
	}
	</script>
	<script async defer
		src="https://maps.googleapis.com/maps/api/js?key={GOOGLE_API_KEY}&callback=initMap">
	</script>
<!-- ENDIF -->
<!-- ENDIF -->
